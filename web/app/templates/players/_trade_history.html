{#
    Trade History Timeline Component

    Displays player's trade history in chronological order.

    Expected data:
    - trade_history: List of TradeHistory objects
    - player: Player object (for context)
#}

{% if trade_history %}
<div class="mt-8 bg-white rounded-lg shadow-lg p-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-6">Transaction History</h2>

    <div class="space-y-6">
        {% for trade in trade_history %}
        <div class="flex gap-4">
            {# Date column #}
            <div class="flex-shrink-0 w-32">
                <div class="text-sm font-semibold text-gray-700">
                    {{ trade.date.strftime('%B %d, %Y') if trade.date else 'Unknown Date' }}
                </div>
                <div class="text-xs text-gray-500">
                    {{ trade.year if trade.year else '-' }}
                </div>
            </div>

            {# Timeline indicator #}
            <div class="flex-shrink-0 flex flex-col items-center">
                <div class="w-4 h-4 bg-blue-500 rounded-full border-4 border-white shadow"></div>
                {% if not loop.last %}
                    <div class="w-0.5 h-full bg-gray-300 mt-1"></div>
                {% endif %}
            </div>

            {# Event content #}
            <div class="flex-grow pb-8">
                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                    <div class="flex items-start justify-between mb-2">
                        <span class="inline-block px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded">
                            TRADE
                        </span>
                    </div>

                    {# Trade summary with HTML links to teams/players #}
                    <div class="text-sm text-gray-700 leading-relaxed">
                        {{ trade.summary|clean_trade_summary|safe }}
                    </div>

                    {# Teams involved #}
                    <div class="mt-3 flex items-center gap-4 text-xs text-gray-600">
                        <div>
                            <span class="font-semibold">From:</span>
                            {% if trade.team_0 %}
                                <a href="{{ url_for('teams.team_detail', team_id=trade.team_0.team_id) }}"
                                   class="text-blue-600 hover:text-blue-800">
                                    {{ trade.team_0.name }}
                                </a>
                            {% else %}
                                Team #{{ trade.team_id_0 }}
                            {% endif %}
                        </div>
                        <div>
                            <span class="font-semibold">To:</span>
                            {% if trade.team_1 %}
                                <a href="{{ url_for('teams.team_detail', team_id=trade.team_1.team_id) }}"
                                   class="text-blue-600 hover:text-blue-800">
                                    {{ trade.team_1.name }}
                                </a>
                            {% else %}
                                Team #{{ trade.team_id_1 }}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <p class="text-xs text-gray-500 mt-6">
        * Showing {{ trade_history|length }} trade{{ 's' if trade_history|length != 1 else '' }} in career
    </p>
</div>
{% endif %}
